function findPts(_0x2d0a81, _0x383858) { _0x383858 = _0x383858 * 0.7; var _0x2bafea = _0x2d0a81[0x0] * Math['PI'] / 0xb4; var _0x521fb2 = _0x2d0a81[0x1] * Math['PI'] / 0xb4; var _0x2c6673 = _0x383858 * 0.609344; var _0x121076 = _0x383858 * 0.609344; var _0x428e97 = Math['PI'] / 0xb4 * ((0x78 - 0x3c) * Math['random']() + 0x3c); var _0x3e9fac = 0.85; var _0x3629fa = _0x3e9fac * _0x121076 / (0x2 + 0x2 * Math['sin'](_0x428e97 / 0x2)); var _0x5463cc = 0xfa0 * Math['cos'](_0x2bafea); var _0x1e05fe = 0x2 * Math['random']() * Math['PI']; var _0x3dc4fa = _0x3629fa * Math['cos'](_0x1e05fe) / 0xfa0 + _0x2bafea; var _0x5703a1 = _0x521fb2 + _0x3629fa * Math['sin'](_0x1e05fe) / _0x5463cc; var _0xe6501d = _0x3629fa * Math['cos'](_0x1e05fe + _0x428e97) / 0xfa0 + _0x2bafea; var _0x16d1e1 = _0x521fb2 + _0x3629fa * Math['sin'](_0x1e05fe + _0x428e97) / _0x5463cc; LatLng2 = [_0x3dc4fa * 0xb4 / Math['PI'], _0x5703a1 * 0xb4 / Math['PI']]; LatLng3 = [_0xe6501d * 0xb4 / Math['PI'], _0x16d1e1 * 0xb4 / Math['PI']]; return [LatLng2, LatLng3]; } function generateRandomTrip() { var _0x405820 = parseInt(document['getElementById']('tripDistanceInput')['value']); if (_0x405820 > 0x32) { document['getElementById']('tripDistanceInput')['value'] = 0x32; alert('La\x20distance\x20maximum\x20de\x20génération\x20d\x27itinéraire\x20est\x20de\x2050\x20kilomètres'); } if (numberOfTryForTrip < 0xa) { var _0x173cd5 = findPts(homeLocationLatLng, _0x405820); var _0x2af715 = new XMLHttpRequest(); _0x2af715['open']('GET', 'https://api.mapbox.com/directions/v5/mapbox/cycling/' + encodeURI(homeLocationLatLng[0x1] + ',' + homeLocationLatLng[0x0] + ';' + _0x173cd5[0x0][0x1] + ',' + _0x173cd5[0x0][0x0] + ';' + _0x173cd5[0x1][0x1] + ',' + _0x173cd5[0x1][0x0] + ';' + homeLocationLatLng[0x1] + ',' + homeLocationLatLng[0x0]) + '.json?access_token=pk.eyJ1IjoiYWJyYWFvYWx2ZXMiLCJhIjoiY2oxbTRzZXBmMDA1ZjJ3bzI3ODZucTM2dCJ9.AICaNFFp-vS2tD5mEHulmA&steps=true&overview=full&geometries=geojson&annotations=distance&continue_straight=true&exclude=ferry', ![]); _0x2af715['send'](null); var _0x5a9b71 = JSON['parse'](_0x2af715['responseText']); var _0x329b5c = []; if (_0x5a9b71['code'] == 'NoRoute') { document['getElementById']('tripDistance')['classList']['add']('hidden'); generateRandomTrip(); return; } var _0x167896 = []; for (var _0x3ba634 = 0x0; _0x3ba634 < _0x5a9b71['waypoints']['length']; _0x3ba634++) { _0x329b5c['push'](L['latLng']([_0x5a9b71['waypoints'][_0x3ba634]['location'][0x1], _0x5a9b71['waypoints'][_0x3ba634]['location'][0x0]])); _0x167896['push'](_0x5a9b71['waypoints'][_0x3ba634]['location']); }; if ((_0x5a9b71['routes'][0x0]['distance'] / 0x3e8)['toFixed'](0x2) - parseInt(document['getElementById']('tripDistanceInput')['value']) > 0x2) { numberOfTryForTrip++; console['log'](numberOfTryForTrip); document['getElementById']('tripDistance')['classList']['add']('hidden'); generateRandomTrip(); return; } numberOfTryForTrip = 0x0; tripLayer['clearLayers'](); L['geoJson'](_0x5a9b71['routes'][0x0]['geometry'], { 'style': { 'color': 'orange' } })['addTo'](tripLayer); map['addLayer'](tripLayer); document['getElementById']('tripDistance')['classList']['remove']('hidden'); document['getElementById']('tripDistanceText')['innerText'] = (_0x5a9b71['routes'][0x0]['distance'] / 0x3e8)['toFixed'](0x2) + '\x20km'; map['setView'](homeLocationLatLng, 0xd); if (isBrowserMobile()) { window['scrollTo'](0x0, document['body']['scrollHeight']); } } else { var _0x118fdd = document['getElementById']('generateRandomTripButton'); _0x118fdd['classList']['add']('opacity-50'); _0x118fdd['classList']['add']('cursor-not-allowed'); _0x118fdd['setAttribute']('disabled', 'true'); _0x118fdd['innerHTML'] = '<span\x20class=\x27ion-alert\x27>\x20Impossible\x20de\x20générer\x20un\x20itinéraire\x20</span>'; return; } }